// A launch configuration that compiles the extension and then opens it inside a new window
// Use IntelliSense to learn about possible attributes.
// Hover to view descriptions of existing attributes.
// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
{
	"version": "0.2.0",
	"configurations": [
		{
			"name": "Extension",
			"type": "extensionHost",
			"request": "launch",
			"args": [
				"${workspaceFolder}/testing-sandbox",
				"${workspaceFolder}/testing-sandbox/helloWorld.ts",
				"--extensionDevelopmentPath=${workspaceFolder}",
			],
			"envFile": "${workspaceFolder}/.env",
			"outFiles": [
				"${workspaceFolder}/dist/**/*.js"
			],
			"sourceMaps": true,
			"preLaunchTask": "${defaultBuildTask}"
		},
		// This is the same as Extension, but it runs with the current project directory and the current file
		//   Limitation: Can't open the same directory in two windows - https://stackoverflow.com/a/51426734/5278310
		//   Instead will just open /src
		// The idea is to test new features on the actual codebase instead of a simple toy project
		// I called it Quine because similar to a quine program, it runs on itself
		// - A quine program is a program that prints its own source code
		{
			"name": "Quine",
			"type": "extensionHost",
			"request": "launch",
			"args": [
				"${workspaceFolder}/src",
				"${file}",
				"--extensionDevelopmentPath=${workspaceFolder}"
			],
			"envFile": "${workspaceFolder}/.env",
			"env": {
				// Our code has a bunch of @bread mentions, so we need to override the default
				"AT_BREAD_IDENTIFIER_OVERRIDE": "crust",
			},
			"outFiles": [
				"${workspaceFolder}/dist/**/*.js"
			],
			"sourceMaps": true,
			"preLaunchTask": "${defaultBuildTask}"
		},
		{
			"name": "Show Me",
			"type": "extensionHost",
			"request": "launch",
			"args": [
				"${workspaceFolder}/../show-me-chatgpt-plugin",
				"--extensionDevelopmentPath=${workspaceFolder}"
			],
			"envFile": "${workspaceFolder}/.env",
			"outFiles": [
				"${workspaceFolder}/dist/**/*.js"
			],
			"sourceMaps": true,
			"preLaunchTask": "${defaultBuildTask}"
		},
		// Docs: https://code.visualstudio.com/api/working-with-extensions/testing-extension
		{
			"name": "Tests",
			"type": "extensionHost",
			"request": "launch",
			"args": [
				"${workspaceFolder}/testing-sandbox",
				"--disable-extensions", // Disables other extensions
				"--extensionDevelopmentPath=${workspaceFolder}",
				"--extensionTestsPath=${workspaceFolder}/out/test/mochaTestRunner.js"
			],
			"envFile": "${workspaceFolder}/.env",
			"env": {
				// This is a cheaper model + it's faster
				// "OPENAI_DEFAULT_MODEL": "gpt-3.5-turbo",
				// Important! The glob needs to match js files, not original ts files
				// Use test.only instead of test in the code to run only one test
				// Use this glob if you want to run only one test suite
				// "TEST_SUITE_GLOB": "**/parse.test.js"
			},
			"outFiles": [
				"${workspaceFolder}/out/**/*.js",
				"${workspaceFolder}/dist/**/*.js"
			],
			"preLaunchTask": "tasks: watch-tests",
			// Because the test compilation tasks or watch tasks they will not rebuild unless content changes
			// So if we just clean the out directory it will not trigger a re-run
			// "postDebugTask": "clean: out-directory"
		}
	]
}